---
title: "TP2"
author: "Loic Marliot"
date: "2025-09-28"
output: html_document
---

```{r setup}
Temperatures <- read.csv2("/home/l/m/lmarliot/R/tp2/Temperatures.csv",header=TRUE,sep=",", dec=".")
```

1.
## 2. Analyse Descriptive
Le fichier _temperature.csv_ donne la température des pays selon le mois, la position géographique des pays, la caractérisation de la position géographique des pays mais aussi leurs températures moyennes et leurs amplitudes

## 3. Matrice centrée-réduite des données

```{r cars}
temperature_Month=Temperatures[,2:13]
for(i in 1:12){
  temperature_Month[,i]=temperature_Month[,i]-mean(temperature_Month[,i])
  temperature_Month[,i]=temperature_Month[,i]/sd(temperature_Month[,i])
}

```

## 4. Matrice de covariance

```{r pressure}

matCovVa=(1/(nrow(temperature_Month)-1)) * t(temperature_Month) %*% as.matrix(temperature_Month)
```
La variance est égale à 1. Cela est normal étant donné qu'on a centré et réduit la matrice.On observe une forte corrélation positive entre les températures de mois appartenant à une même saison. Cependant, il y a tout de même une corrélation entre des mois de différentes saisons, indiquant que les chaleurs d'une saison peuvent impacter les suivantes, même à plusieurs mois d'écart.

## 5. Vecteurs et valeurs propres
```{r}
eigen(matCovVa)
```
## 6. Contribution relative des axes
```{r}
propre=eigen(matCovVa)
init=c()
i=0
for (lb in propre$values){
  x=lb/sum(propre$values)
  init=c(init,x)
}
```
Je choisi le critère de variance cumulé. Je choisirai de garder les composantes principales portant plus de 90% de l'information. 
```{r}
info=0
i=0
while (info<=0.9){
  i=i+1
  info=init[i]+info
  
}
plot(init)
```
Je retiendrai 2 axes pour l'analyse car ils contiennent à eux seuls plus de 90% de l'information.
```{r}
matIndividus=as.matrix(temperature_Month) %*% as.matrix(eigen(matCovVa)$vectors)

plot(matIndividus[,1],matIndividus[,2],main="Plan factoriel 1",xlim=c(-1,1), ylim=c(-1,1))
text(matIndividus[,1],matIndividus[,2],labels=Temperatures[,1])
```


```{r}
plot(matIndividus[,1],matIndividus[,3],main="Plan factoriel 2",xlim=c(-1,1), ylim=c(-1,1))
text(matIndividus[,1],matIndividus[,3],labels=Temperatures[,1])
```
```{r}
plot(matIndividus[,2],matIndividus[,3],main="Plan factoriel 3",xlim=c(-1,1), ylim=c(-1,1))
text(matIndividus[,2],matIndividus[,3],labels=Temperatures[,1])
```

## 8.Qualité de représentation

```{r}
cos=matIndividus*matIndividus
for (i in 1:35){
cos[i,]=cos[i,]/sum(temperature_Month[i,]*temperature_Month[i,])
}
```
## Contribution
```{r}
ctr=matIndividus*matIndividus
for (i in 1:12){
  ctr[,i]=ctr[,i]/(34*propre$values[i])
}

```
```{r}
indCtr=c()
indCos=c()

  for (i in 1:35){
    if(ctr[i,1]>mean(ctr[,1])){
      indCtr=c(indCtr,Temperatures[i,1])
    }
    if(cos[i,1]>mean(cos[,1])){
      indCos=c(indCos,Temperatures[i,1])
    }
  }

```

a.Les pays ayant les meilleurs qualités (qualité > à la moyenne )sont `r indCos` pour l'axe 1
b.Les pays ayant les meilleurs contributions (contribution > à la moyenne) sont `r indCtr` pour l'axe 1

## 9. Coordonnées
```{r}
valPropreColonne=matrix(propre$values,ncol=1)
matriceVectPropre=matrix(propre$vectors,ncol=12,nrow=12)
MatriceCoordonnée= matrix(nrow=12,ncol=12) 

for(k in 1:12 )
{
  MatriceCoordonnée[,k]=propre$vectors[,k] * sqrt(propre$values[k]) 
}
```
### Représentation Graphique
```{r}
plot(MatriceCoordonnée[,1],MatriceCoordonnée[,2],xlim=c(-1,1), ylim=c(-1,1))
text(MatriceCoordonnée[,1],MatriceCoordonnée[,2],labels=colnames(Temperatures)[2:13])
```


## 9. Rprésentation et contribution des variables
```{r}
cosVar=MatriceCoordonnée*MatriceCoordonnée
for ( i in 1:12){
  cosVar[i,]=cosVar[i,]/(sum(cosVar[i,]))
}
```

```{r}
ctrVar=MatriceCoordonnée*MatriceCoordonnée
for ( i in 1:12){
  ctrVar[i,]=cosVar[i,]/(propre$values*sum(ctrVar[i,]))
}
```
```{r}
coorCtr=c()
coorCos=c()

  for (i in 1:12){
    if(ctrVar[i,1]>mean(ctrVar[,1])){
      coorCtr=c(coorCtr,colnames(Temperatures)[i])
    }
    if(cosVar[i,1]>mean(cosVar[,1])){
      coorCos=c(coorCos,colnames(Temperatures)[i])
    }
  }
```
a.Les mois ayant les meilleurs qualités (qualité > à la moyenne )sont `r coorCos` pour l'axe 1
b.Les mois ayant les meilleurs contributions (contribution > à la moyenne) sont `r coorCtr` pour l'axe 1

## 11. Interprétation

Les individus sont bien répartis tout le long de l'axe 1 mais peu sur l'axe 2. Cela s'explique par la différence de proportion d'inertie des valeurs propres 1 et 2 (0.86 pour lambda 1 et 0.09 pour lambda 2).
On peut considérer que l'axe 1 représente la part de chaleur. Les villes sont regroupées par leurs niveaux de chaleur. Les villes des pays du "nord", du "sud" et du "centre" de l'Europe sont regroupée en cluster entre eux.
Cependant il est difficle d'émettre une interprétation des variables le long de l'axe 1, mise à part le fait qu'étant donné que se sont des mois, il est difficile de les différencier car ils sont tous fortement corrélés.

Même si la part d'inertie de l'axe 2 est faible, nous avons décidé de garder cet axe. Ainsi, il peut être porteur d'information. Tout d'abord, comme l'environnement des villes, si la ville est entourée de montagne, de forêt pouvant influencer la chaleur.